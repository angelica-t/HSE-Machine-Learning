Лабораторная работа 1.
На основании транзакционных данных клиентов, а также их социально-демографических характеристик обучить линейную модель вероятности визита клиента в следущие полгода. Данные: https://yadi.sk/d/O2jjJGkrDFDyMA. Задачи:
1. Считать файлы из формата CSV. Необходимо правильно настроить разделитель между ячейками и десятичный разделитель.
2. Для каждого клиента по транзакционным данным необходимо:
◦ Зафикисировать дату 2017-07-01 как дату, на которую считаются характеристики клиентов.
◦ Для каждого клиента определить, совершал ли он визит в период между 2017-07-01 и 2017-12-31 включительно. Полученный флаг является зависимой переменной Y, которую требуется предсказывать
◦ Для каждого клиента расчитать Recency (количество дней до последнего визита клиента перед зафиксированной датой 2017-07-01), Frequency (средняя частота походов клиентов на дату 2017-07-01, измеряется как среднее количество визитов в месяц за время между 2017-07-01 и первым визитом клиента) и Monetary Value (средний чек клиента по всем покупкам до 2017-07-01).
◦ Для каждого клиента студенту необходимо самостоятельно придумать и расчитать характеристику клиента по транзакционным данным, которая могла бы помочь предсказывать зависимую переменную Y.
◦ Все задания этого пункта выполняются через «pandas.DataFrame.groupby»
3. Для каждого клиента к уже рассчитанным характеристикам необходимо из второй таблицы притянуть данные по полу и возрасту клиента.
4. Разбить клиентов случайно на две группы в соотношении 80:20. Большая группа — это обучающая выборка, а маленькая группа это тестовая выборка.
5. Обучить модель логистической регрессии на обучающей выборке.
6. Предсказать вероятность прихода на тестовой выборке.
7. Посчитать метрики Precision и Recall на основании предсказаний на тестовой выборке и истинных значений зависимой переменной Y.


Лабораторная работа 2.
Реализовать обучения моделей и предсказание с их помощью в задаче классификации. Для каждой модели необходимо реализовать две функции trainNAME и predictNAME, где NAME имя модели. Данные функции имеют следующии сигнатуры: model = trainNAME(X, Y, ...{other params}...), predictNAME(model, X), где {other params}  – это параметры определяемые студентом, включающие все используемые в модели константы, model – обученная модель, возвращаемая первой функцией. Функция предсказания должна возвращать вероятность класса 1. Все модели реализуются самостоятельно студентами, без использования библиотеки sklearn и подобных. В рамках лабораторной работы требуется реализовать:
● Дерево решений (разбиение происходит на основании энтропийного критерия, предсказания внутри листа дерева – константное, критерий остановки – величина листа и глубина дерева)
● Случайный лес (внутренняя модель – дерево решений)
● Градиентный бустинг (внутреняя модель – дерево решений, псевдо-остатки считаются из логистической функции потерь «logistic loss», длина шага – константа, предсказание должно использовать logit преобразование)
Инструкции по работе с лабой:
1. Написать функции trainRND и predictRND для построния модели, возвращающуюся случайной вероятность принадлежности к классу 1 для каждой точки тестовой выборки.
2. Подобрать выборку данных для задачи классификации на два класса (каждого класса не менее 20%, выборка содержит не менее 500 наблюдений). Разбить выборку данных на обучающую и тестовую выборку в пропорции 80:20.
3. Обучить на обучающей выборке и предсказать на тестовой выборке зависимую переменную с помощью случайной модели. Построить ROC-кривую для этой модели.
4. Написать функции trainNAME и predictNAME для каждой из моделей
5. Добавить ROC-кривые для каждой из моделей на тестовой выборке.

Лабораторная работа 3.
Обучить и сравнить качество нескольких предсказательных моделей в задаче регрессии.
В лабораторной работе рассматривается задача предсказания выручки с каждого клиента магазина Gstore. Данные и подробное описание задачи может быть найдено тут https://www.kaggle.com/c/ga-customer-revenue-prediction/data (файл train.csv). При необходимости для ускорения процесса обучения можно взять только 10% случайных (!) строк данных. Задачи данной лабораторной работы:
● подобрать признаки (не менее 10, в т.ч. не менее 5 расчётных, отсутсвующих в данных явно), которые могут помочь в построении модели. По каждому расчитаному признаку пояснить, почему этот признак может быть важен.
● обучить несколько классических моделей машинного обучения для задачи регрессии, включая GBM на дереьвях решений, лес решений, SVM, линейная регрессия. Зависимая переменная – логарифм от выручки с клиента
● настроить гиперпараметры моделей.
● С помощью 5-fold кросс валидации посчитать среднее качество каждой из моделей.
● С помощью 20 случайных разбиений оценить дисперсию оценки каждой из моделей.
● Визуализировать полученные распределения метрик качества каждой из модели с помощью boxplot`ов, также отразить посчитанное ранее среднее качество.